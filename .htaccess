# ==============================================================================
# BÍBLIA ONLINE - CONFIGURAÇÃO DO APACHE (.htaccess)
# ==============================================================================

<IfModule mod_rewrite.c>
    # --------------------------------------------------------------------------
    # Forçar HTTPS
    # Redireciona todo o tráfego HTTP para HTTPS para garantir a segurança.
    # --------------------------------------------------------------------------
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

    # --------------------------------------------------------------------------
    # Proteção contra Injeção de Ficheiros (File Injection)
    # Bloqueia tentativas de acesso a diretórios pais (ex: ../).
    # --------------------------------------------------------------------------
    RewriteCond %{REQUEST_URI} \.\./ [OR]
    RewriteCond %{REQUEST_URI} \.\.//
    RewriteRule (.*) - [F,L]
</IfModule>

# ------------------------------------------------------------------------------
# Performance - Compressão GZIP/DEFLATE
# Comprime os ficheiros antes de os enviar ao navegador, reduzindo o tempo de
# carregamento.
# ------------------------------------------------------------------------------
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
    AddOutputFilterByType DEFLATE application/x-font
    AddOutputFilterByType DEFLATE application/x-font-opentype
    AddOutputFilterByType DEFLATE application/x-font-truetype
    AddOutputFilterByType DEFLATE application/x-font-ttf
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE font/opentype
    AddOutputFilterByType DEFLATE font/otf
    AddOutputFilterByType DEFLATE font/ttf
    AddOutputFilterByType DEFLATE image/svg+xml
    AddOutputFilterByType DEFLATE image/x-icon
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/xml

    # Remove bugs de alguns navegadores mais antigos.
    BrowserMatch ^Mozilla/4 gzip-only-text/html
    BrowserMatch ^Mozilla/4\.0[678] no-gzip
    BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
    Header append Vary User-Agent
</IfModule>

# ------------------------------------------------------------------------------
# Performance - Controlo de Cache (Expires Headers)
# Define por quanto tempo o navegador deve armazenar os ficheiros em cache.
# ------------------------------------------------------------------------------
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault                                "access plus 1 month"
    ExpiresByType text/css                        "access plus 1 year"
    ExpiresByType text/plain                      "access plus 1 month"
    ExpiresByType text/html                       "access plus 0 seconds"
    ExpiresByType application/javascript          "access plus 1 year"
    ExpiresByType application/json                "access plus 0 seconds"
    ExpiresByType application/xml                 "access plus 0 seconds"
    ExpiresByType image/x-icon                    "access plus 1 week"
    ExpiresByType image/gif                       "access plus 1 month"
    ExpiresByType image/png                       "access plus 1 month"
    ExpiresByType image/jpeg                      "access plus 1 month"
    ExpiresByType video/ogg                       "access plus 1 month"
    ExpiresByType audio/ogg                       "access plus 1 month"
    ExpiresByType video/mp4                       "access plus 1 month"
    ExpiresByType video/webm                      "access plus 1 month"
    ExpiresByType application/pdf                 "access plus 1 month"
    ExpiresByType font/ttf                        "access plus 1 year"
    ExpiresByType font/otf                        "access plus 1 year"
    ExpiresByType font/woff                       "access plus 1 year"
    ExpiresByType font/woff2                      "access plus 1 year"
    ExpiresByType image/svg+xml                   "access plus 1 year"
</IfModule>

# ------------------------------------------------------------------------------
# Segurança - Ocultar Assinatura do Servidor
# Remove a versão do Apache da resposta do servidor, dificultando a identificação
# de possíveis vulnerabilidades.
# ------------------------------------------------------------------------------
ServerSignature Off

# A seção abaixo é gerada pelo cPanel e não deve ser editada manualmente.
# php -- BEGIN cPanel-generated handler, do not edit
# Defina o pacote “ea-php82” como a linguagem padrão de programação “PHP”.
<IfModule mime_module>
  AddHandler application/x-httpd-ea-php82___lsphp .php .php8 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit
